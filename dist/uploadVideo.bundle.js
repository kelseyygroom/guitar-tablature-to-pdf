(()=>{"use strict";var t={};t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),(()=>{var e;t.g.importScripts&&(e=t.g.location+"");var n=t.g.document;if(!e&&n&&(n.currentScript&&"SCRIPT"===n.currentScript.tagName.toUpperCase()&&(e=n.currentScript.src),!e)){var i=n.getElementsByTagName("script");if(i.length)for(var o=i.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=i[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),t.p=e})();const e=t.p+"43d520b41e29c0e86dd4.svg";var n=function(t,e,n,i){return new(n||(n=Promise))((function(o,r){function l(t){try{s(i.next(t))}catch(t){r(t)}}function a(t){try{s(i.throw(t))}catch(t){r(t)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(l,a)}s((i=i.apply(t,e||[])).next())}))};const i="https://guitar-tablature-to-pdf-147ddb720da0.herokuapp.com/";let o,r=null;class l{constructor(){this.TIMER=5,this.openWelcomePopupModal=t=>{const e=document.getElementById("tutorial-modal"),n=document.getElementById("tutorial-modal-overlay");e.innerHTML=t,e.style.display="flex",n.style.display="flex",document.getElementById("welcome-confirm-button").addEventListener("click",(()=>{const t=document.getElementById("upload-file-button"),e=document.getElementById("tutorial-modal"),n=document.getElementById("tutorial-modal-overlay");e.style.display="none",n.style.display="none",setTimeout((()=>{t.classList.add("tab-cell-active-tutorial")}),500)}))},this.openSelectFirstClipPopupModal=t=>{const e=document.getElementById("tutorial-modal"),n=document.getElementById("tutorial-modal-overlay"),i=document.getElementById("selected-tab-indicator");e.innerHTML=t,e.style.display="flex",n.style.display="flex",i.classList.remove("tab-cell-active-tutorial"),document.getElementById("welcome-confirm-button").addEventListener("click",(()=>{const t=document.getElementsByClassName("tab-chunk-text"),e=document.getElementById("tutorial-modal"),n=document.getElementById("tutorial-modal-overlay");e.style.display="none",n.style.display="none",setTimeout((()=>{t[0].classList.add("tab-cell-active-tutorial")}),500)}))},this.openSelectClipPopupModal=t=>{const e=document.getElementById("tutorial-modal"),n=document.getElementById("tutorial-modal-overlay");e.innerHTML=t,e.style.display="flex",n.style.display="flex",document.getElementById("welcome-confirm-button").addEventListener("click",(()=>{const t=document.getElementById("selected-tab-indicator"),e=document.getElementById("tutorial-modal"),n=document.getElementById("tutorial-modal-overlay");e.style.display="none",n.style.display="none",setTimeout((()=>{t.classList.add("tab-cell-active-tutorial")}),500)}))},this.openSetStartPointPopupModal=t=>{const e=document.getElementById("tutorial-modal"),n=document.getElementById("tutorial-modal-overlay"),i=document.getElementsByClassName("tab-chunk-text");e.innerHTML=t,e.style.display="flex",n.style.display="flex",i[0].classList.remove("tab-cell-active-tutorial"),document.getElementById("welcome-confirm-button").addEventListener("click",(()=>{const t=document.getElementById("start-tab-segment-button"),e=document.getElementById("tutorial-modal"),n=document.getElementById("tutorial-modal-overlay");e.style.display="none",n.style.display="none",setTimeout((()=>{t.classList.add("tab-cell-active-tutorial")}),500)}))},this.openSetEndPointPopupModal=t=>{const e=document.getElementById("tutorial-modal"),n=document.getElementById("tutorial-modal-overlay"),i=document.getElementById("start-tab-segment-button");e.innerHTML=t,e.style.display="flex",n.style.display="flex",i.classList.remove("tab-cell-active-tutorial"),document.getElementById("welcome-confirm-button").addEventListener("click",(()=>{const t=document.getElementById("end-tab-segment-button"),e=document.getElementById("tutorial-modal"),n=document.getElementById("tutorial-modal-overlay");e.style.display="none",n.style.display="none",setTimeout((()=>{t.classList.add("tab-cell-active-tutorial")}),500)}))},this.openTutorialDownloadPopupModal=t=>{const e=document.getElementById("tutorial-modal"),n=document.getElementById("tutorial-modal-overlay"),i=document.getElementById("end-tab-segment-button");e.innerHTML=t,e.style.display="flex",n.style.display="flex",i.classList.remove("tab-cell-active-tutorial"),document.getElementById("welcome-confirm-button").addEventListener("click",(()=>{document.getElementById("end-tab-segment-button");const t=document.getElementById("tutorial-modal"),e=document.getElementById("tutorial-modal-overlay");t.style.display="none",e.style.display="none",setTimeout((()=>{const t=document.getElementById("start-record");document.getElementById("end-tab-segment-button").classList.remove("tab-cell-active-tutorial"),t.classList.add("tab-cell-active-tutorial")}),500)}))},this.openNotificationPopupModal=t=>{const e=document.getElementById("tutorial-modal"),n=document.getElementById("tutorial-modal-overlay");e.innerHTML=t,e.style.display="flex",n.style.display="flex";const i=document.getElementById("welcome-confirm-button"),o=document.getElementById("welcome-back-button");i.addEventListener("click",(()=>{e.style.display="none",n.style.display="none"})),o.addEventListener("click",(()=>{window.location.href="create.html?username="+this.user.username+"&title="+this.tabTitle}))},this.initWelcomeTutorialFlow=()=>{const t=document.createElement("label"),e=document.createElement("button");e.id="welcome-confirm-button",e.innerHTML="Let's upload it!",t.innerHTML="<h3>Time to create your first TabTok Video!</h3> <p>Now grab your guitar and take your video!</p> <p>You can upload a video up to 1 minute long.</p> <p>Since this is the tutorial, try playing an open string and hold it for 10 seconds.</p>",setTimeout((()=>{this.openWelcomePopupModal(t.outerHTML+e.outerHTML)}),1)},this.initNotificationFlow=()=>{const t=document.createElement("label"),e=document.createElement("button"),n=document.createElement("button");n.id="welcome-back-button",e.id="welcome-confirm-button",e.innerHTML="Sweet",n.innerHTML="Go back",t.innerHTML="TabTok's Tab Video Feature is now operational! Enjoy the Feature!",setTimeout((()=>{this.openNotificationPopupModal(t.outerHTML+e.outerHTML+n.outerHTML)}),1)},this.initSelectClipTutorialFlow=()=>{const t=document.createElement("label"),e=document.createElement("button");e.id="welcome-confirm-button",e.innerHTML="Got it!",t.innerHTML='<h3>Time to match the clip!</h3><p>We must first select the clip we would like to place on our video timeline.</p><p>Let\'s open our editing tools by selecting "Select Clip".</p>',setTimeout((()=>{this.openSelectClipPopupModal(t.outerHTML+e.outerHTML)}),1)},this.initSelectFirstClipTutorialFlow=()=>{const t=document.createElement("label"),e=document.createElement("button");e.id="welcome-confirm-button",e.innerHTML="Let's select it!",t.innerHTML="<h3>Great Work!</h3><p>Now that our editing tools are open, let's select the clip we will place on the video timeline.</p><p>How about this first one?</p>",setTimeout((()=>{this.openSelectFirstClipPopupModal(t.outerHTML+e.outerHTML)}),1)},this.initSetStartPointFlow=()=>{const t=document.createElement("label"),e=document.createElement("button");e.id="welcome-confirm-button",e.innerHTML="Got it!",t.innerHTML="<h3>Excellent!</h3><h3> Now match the clip to the video.</h3><p>First close the video editing tools using the down arrow.</p> <p>Then scroll the point on the video that you plucked the open string, then pause at that point of the video.</p> <p>Click the flashing 'Begin Clip' button.</p> <p>The start time of the clip will be set where the dot on the scroll bar is.</p>",setTimeout((()=>{this.openSetStartPointPopupModal(t.outerHTML+e.outerHTML)}),1)},this.initSetEndPointFlow=()=>{const t=document.createElement("label"),e=document.createElement("button");e.id="welcome-confirm-button",e.innerHTML="Got it!",t.innerHTML='<h3>Good Work!</h3><h3> Now set the end time for the clip.</h3><p>You\'ll see that the green colored bar has moved on the timeline.</p><p>This means the clip will appear on the video beginning at this point.</p><p>Now we end the clip the same way, but this time try using the flashing "End Clip" button.</p> ',setTimeout((()=>{this.openSetEndPointPopupModal(t.outerHTML+e.outerHTML)}),1)},this.initSaveMP4Flow=()=>{const t=document.createElement("label"),e=document.createElement("button");e.id="welcome-confirm-button",e.innerHTML="Got it!",t.innerHTML='<h3>Finished!</h3><p>See how easy this is?</p><h3>Now generate and download your TabTok video!</h3><p>Make sure to watch the video all the way through. When finished, click the flashing "Download Video" button on the top right.</p><p>Since this is the Tutorial, a video will not be created at this time.</p>',setTimeout((()=>{this.openTutorialDownloadPopupModal(t.outerHTML+e.outerHTML)}),1)},this.initTutorial=()=>{this.initWelcomeTutorialFlow()},this.init=()=>{this.getUserAccount(),this.addTabSegmentListeners(),this.addBackButtonListener()},this.addClosePopupListener=()=>{document.getElementById("close-tab-chunk-container-icon").addEventListener("click",(()=>{const t=document.querySelectorAll('input[type="radio"].font-radio:checked'),e=document.querySelectorAll('input[type="radio"].color-radio:checked'),n=t[0],i=(n&&n.value,e[0]),o=i?i.value:"Black";l.tabBackgroundColor=o,document.getElementById("popup-modal").style.display="none"}))},this.addMarkers=()=>{const t=l.videoDuration,e=document.querySelector(".markers"),n=this.getVideoTime(l.tabChunks.highEString),i=[],o=[];n.forEach((t=>{i.push(t.start),o.push(t.end)})),e.innerHTML="",i.forEach(((n,i)=>{const r=document.createElement("div");r.classList.add("marker");const l=n/t*100,a=o[i]/t*100;r.style.left=`${l}%`,r.style.width=a-l+"%",r.style.backgroundColor=`${this.tabClipSegmentColors[i]}`,r.style.opacity=".5",e.appendChild(r)}))},this.getVideoText=t=>{const e=[];return t.forEach((t=>{e.push(t.text)})),e},this.getVideoTime=t=>{const e=[];return t.forEach((t=>{e.push(t.time)})),e},this.buildTabChunkHTML=()=>{const t=document.createElement("div");t.classList.add("tab-chunk-container");for(let e=0;e<Object.keys(l.tabChunks.highEString).length;e++){const n=document.createElement("div");n.id="tab-chunk-"+l.tabChunks.highEString[e].id,n.classList.add("tab-chunk-text");const i=document.createElement("p");i.innerHTML=l.tabChunks.highEString[e].text,n.append(i);const o=document.createElement("p");o.innerHTML=l.tabChunks.bString[e].text,n.append(o);const r=document.createElement("p");r.innerHTML=l.tabChunks.gString[e].text,n.append(r);const a=document.createElement("p");a.innerHTML=l.tabChunks.dString[e].text,n.append(a);const s=document.createElement("p");s.innerHTML=l.tabChunks.aString[e].text,n.append(s);const d=document.createElement("p");d.innerHTML=l.tabChunks.eString[e].text,n.append(d),n.style.backgroundColor=this.tabClipSegmentColors[e],n.setAttribute("color",this.tabClipSegmentColors[e]),t.append(n)}let e="<div>";e+="<div style='color: grey; margin-bottom: .25rem; padding-left: .25rem; font-size: 1.5rem;'>Background Color</div>",e+="<input type='radio' class='color-radio' id='font-color-black' name='font-color' value='black' checked />",e+="<label for='font-color-black'>Black</label>",e+="</div>",e+="<div>",e+="<input type='radio' class='color-radio' id='font-color-red' name='font-color' value='red' />",e+="<label for='font-color-red'>Red</label>",e+="</div>",e+="<div>",e+="<input type='radio' class='color-radio' id='font-color-blue' name='font-color' value='blue' />",e+="<label for='font-color-blue'>Blue</label>",e+="</div>",e+="<div>",e+="<input type='radio' class='color-radio' id='font-color-purple' name='font-color' value='purple' />",e+="<label for='font-color-purple'>Purple</label>",e+="</div>",e+="<div>",e+="<input type='radio' class='color-radio' id='font-color-green' name='font-color' value='green' />",e+="<label for='font-color-green'>Green</label>",e+="</div>",e+="<div>",e+="<input type='radio' class='color-radio' id='font-color-orange' name='font-color' value='orange' />",e+="<label for='font-color-orange'>Orange</label>",e+="</div>";let n="<div>";n+="<div style='color: grey; margin-bottom: .25rem; padding-left: .25rem; font-size: 1.5rem;'>Font Family</div>",n+="<input type='radio' class='font-radio' id='font-Inconsolata-Regular' name='font-type' value='Inconsolata-Regular' checked />",n+="<label for='font-Inconsolata-Regular'>Inconsolata Regular</label>",n+="</div>",n+="</div>";const i=document.createElement("i"),o=document.createElement("div"),r=document.createElement("div");return o.innerHTML="<div><div style='color: grey; margin-bottom: .25rem; padding-left: .25rem; font-size: 1.5rem;'>Background Color</div><input type='radio' class='color-radio' id='font-color-black' name='font-color' value='black' checked /><label for='font-color-black'>Black</label></div><div><input type='radio' class='color-radio' id='font-color-red' name='font-color' value='red' /><label for='font-color-red'>Red</label></div><div><input type='radio' class='color-radio' id='font-color-blue' name='font-color' value='blue' /><label for='font-color-blue'>Blue</label></div><div><input type='radio' class='color-radio' id='font-color-purple' name='font-color' value='purple' /><label for='font-color-purple'>Purple</label></div><div><input type='radio' class='color-radio' id='font-color-green' name='font-color' value='green' /><label for='font-color-green'>Green</label></div><div><input type='radio' class='color-radio' id='font-color-orange' name='font-color' value='orange' /><label for='font-color-orange'>Orange</label></div>",r.innerHTML="<div><div style='color: grey; margin-bottom: .25rem; padding-left: .25rem; font-size: 1.5rem;'>Font Family</div><input type='radio' class='font-radio' id='font-Inconsolata-Regular' name='font-type' value='Inconsolata-Regular' checked /><label for='font-Inconsolata-Regular'>Inconsolata Regular</label></div></div>",o.style.width="100%",r.style.width="100%",o.style.paddingLeft="2rem",r.style.paddingLeft="2rem",o.style.paddingBlock=".25rem",r.style.paddingBlock=".25rem",r.style.paddingBottom="6rem",i.classList.add("fas"),i.classList.add("fa-angle-down"),i.id="close-tab-chunk-container-icon",t.prepend(i),t.append(o),t.append(r),t.outerHTML},this.adjustTabChunkTime=t=>{const e=t.id.split("-")[2];l.selectedTabChunkId=e},this.addBackButtonListener=()=>{const t=document.getElementById("return-to-tab-button");t&&t.addEventListener("click",(()=>{window.location.href="create.html?username="+this.user.username+"&title="+this.tabTitle}))},this.addTabSegmentListeners=()=>{const t=document.getElementById("start-tab-segment-button"),e=document.getElementById("end-tab-segment-button"),n=document.getElementById("video-timeline");t&&e&&(t.addEventListener("click",(()=>{t.style.backgroundColor="#C8B273",setTimeout((()=>{t.style.backgroundColor="white"}),500);for(let t=0;t<Object.keys(l.tabChunks.highEString).length;t++)l.tabChunks.highEString[t].id===Number(l.selectedTabChunkId)&&(l.tabChunks.highEString[t].time.start=Number(n.value)*l.videoDuration/100),l.tabChunks.bString[t].id===Number(l.selectedTabChunkId)&&(l.tabChunks.bString[t].time.start=Number(n.value)*l.videoDuration/100),l.tabChunks.gString[t].id===Number(l.selectedTabChunkId)&&(l.tabChunks.gString[t].time.start=Number(n.value)*l.videoDuration/100),l.tabChunks.dString[t].id===Number(l.selectedTabChunkId)&&(l.tabChunks.dString[t].time.start=Number(n.value)*l.videoDuration/100),l.tabChunks.aString[t].id===Number(l.selectedTabChunkId)&&(l.tabChunks.aString[t].time.start=Number(n.value)*l.videoDuration/100),l.tabChunks.eString[t].id===Number(l.selectedTabChunkId)&&(l.tabChunks.eString[t].time.start=Number(n.value)*l.videoDuration/100);r=l.tabChunks,this.addMarkers(),"Tutorial"===this.tabTitle&&this.initSetEndPointFlow()})),e.addEventListener("click",(()=>{"Tutorial"===this.tabTitle&&this.initSaveMP4Flow(),e.style.backgroundColor="#C8B273",setTimeout((()=>{e.style.backgroundColor="white"}),500);for(let t=0;t<Object.keys(l.tabChunks.highEString).length;t++){if(l.tabChunks.highEString[t].time.start>n.value)return;l.tabChunks.highEString[t].id===Number(l.selectedTabChunkId)&&(l.tabChunks.highEString[t].time.end=Number(n.value)*l.videoDuration/100),l.tabChunks.bString[t].id===Number(l.selectedTabChunkId)&&(l.tabChunks.bString[t].time.end=Number(n.value)*l.videoDuration/100),l.tabChunks.gString[t].id===Number(l.selectedTabChunkId)&&(l.tabChunks.gString[t].time.end=Number(n.value)*l.videoDuration/100),l.tabChunks.dString[t].id===Number(l.selectedTabChunkId)&&(l.tabChunks.dString[t].time.end=Number(n.value)*l.videoDuration/100),l.tabChunks.aString[t].id===Number(l.selectedTabChunkId)&&(l.tabChunks.aString[t].time.end=Number(n.value)*l.videoDuration/100),l.tabChunks.eString[t].id===Number(l.selectedTabChunkId)&&(l.tabChunks.eString[t].time.end=Number(n.value)*l.videoDuration/100)}r=l.tabChunks,this.addMarkers()})))},this.saveVideo=(t,e)=>n(this,void 0,void 0,(function*(){const n=document.getElementById("start-record"),i=document.getElementById("loading-modal"),o=document.getElementById("loading-message");n.addEventListener("click",(()=>{if(!r)return;i.style.display="flex",o.innerHTML="<p style='text-align: center;'>Uploading your video to TabTok...</p>";const n=e.replace(/ /g,"_"),a=new URLSearchParams(window.location.search),s=a.get("username"),d=a.get("title"),g=new FormData;let c=JSON.stringify(r);r?(g.append("video",t,`${n}.mp4`),g.append("username",s),g.append("tabTitle",d),g.append("tabData",c),g.append("tabColor",l.tabBackgroundColor),g.append("tabFont",l.tabFont),this.uploadWithRetry(g,o,i,s)):c=JSON.stringify(l.tabChunks)}))})),this.uploadWithRetry=(t,e,r,l,...a)=>n(this,[t,e,r,l,...a],void 0,(function*(t,e,n,r,l=20){if("Tutorial"===this.tabTitle)return e.innerHTML="<h3 style='text-align: center;'>Great work! The tutorial is complete!</h3><p style='text-align: center;'>You'll be returned to your home page where you can create your very own TabTok video!</p><p style='text-align: center;'>Try creating your own tabs, and add them to your guitar videos!</p><p style='text-align: center;'>Feel free to delete the tutorial at this time, or keep it around in case you have questions!</p>",void setTimeout((()=>{window.location.href="home.html?username="+r}),12500);{o=new AbortController;const a=o.signal;try{const n=yield fetch(i+"convert",{method:"POST",body:t,signal:a});if(!n.ok)throw new Error("Server error");return e.innerHTML="<h3 style='text-align: center;'>Upload Complete!</h3><p style='text-align: center;'>Your video will be available for download on the homepage in a few minutes.</p><p style='text-align: center;'>Please note that your video will only be available for download for the next hour.</p>",this.user.username.includes("Guest")&&(e.innerHTML+="<p>As a guest, do not close TabTok in your browser. This account is only temporary and you will not be able to download your video if you close this page.</p>"),setTimeout((()=>{window.location.href="home.html?username="+r}),5e3),yield n.json()}catch(i){if(l>0)return 17===l?e.innerHTML="<p style='text-align: center;'>ðŸŸ¡ Slow connection...</p>":l<10&&(e.innerHTML="<p style='text-align: center;'>ðŸŸ¡ Very slow connection...</p><p style='text-align: center;'>Consider switching to WIFI for upload.</p>"),yield new Promise((t=>setTimeout(t,2e3))),this.uploadWithRetry(t,e,n,r,l-1);throw setTimeout((()=>{e.innerHTML="There was problem uploading your video to TabTok ðŸ˜­",n.style.display="none"}),5e3),i}}})),this.initVideoUpload=()=>{const t=document.getElementById("video-icon"),n=document.getElementById("video-editing-tool-container"),i=document.getElementById("video-upload"),o=document.getElementById("video-canvas"),r=o.getContext("2d"),a=document.getElementById("video"),s=document.getElementById("video-timeline"),d=document.getElementById("pause-icon"),g=document.getElementById("play-pause-area");t.src=e,d.style.display="flex";const c=this.getVideoText(l.tab.highEString),u=this.getVideoText(l.tab.bString),h=this.getVideoText(l.tab.gString),m=this.getVideoText(l.tab.dString),p=this.getVideoText(l.tab.aString),b=this.getVideoText(l.tab.eString),S=this.getVideoTime(l.tabChunks.highEString),y=this.getVideoTime(l.tabChunks.bString),v=this.getVideoTime(l.tabChunks.gString),f=this.getVideoTime(l.tabChunks.dString),E=this.getVideoTime(l.tabChunks.aString),T=this.getVideoTime(l.tabChunks.eString);let k=["","","","","",""];function L(t,e,n){const i=a.currentTime;k[n]="",e.forEach(((e,o)=>{i>=e.start&&i<e.end&&(k[n]=t[o])}))}i.addEventListener("change",(e=>{var i;const s=document.getElementById("video-container"),c=document.getElementById("upload-video-buttons-container"),u=null===(i=e.target.files)||void 0===i?void 0:i[0];if(u){s.style.display="flex","Tutorial"===this.tabTitle&&this.initSelectClipTutorialFlow(),this.selectClip(),n.style.display="block",t.style.display="none",c.style.display="none",d.addEventListener("click",(()=>{l.isVideoPlaying?(a.pause(),l.isVideoPlaying=!1,d.style.display="flex"):(a.play(),l.isVideoPlaying=!0,d.style.display="none")})),g.addEventListener("click",(()=>{l.isVideoPlaying?(a.pause(),l.isVideoPlaying=!1,d.style.display="flex"):(a.play(),l.isVideoPlaying=!0,d.style.display="none")}));const e=URL.createObjectURL(u);a.style.visibility="hidden",a.src=e,a.loop=!0,a.addEventListener("loadedmetadata",(()=>{a.duration>60?(alert("The video you chose or recorded is too long, please keep the video under 60 seconds."),window.location.reload()):(l.videoDuration=a.duration,this.saveVideo(u,this.tabTitle))}),{once:!0})}function h(){if(a.paused||a.ended)return;r.clearRect(0,0,o.width,o.height),r.drawImage(a,0,0,o.width,o.height);const t=r.canvas.width,e=.033*t;r.font=`${e}px Monospace`,r.strokeStyle="white",r.lineWidth=.002*e,r.textAlign="left",r.fillStyle="black",k.forEach(((e,n)=>{if(e){const i=45,a=o.height-15*(6-n)-50;n%6==0&&(r.fillStyle=l.colorMap[l.tabBackgroundColor],r.fillRect(i-10,a-15,.75*t,100)),r.fillStyle="white",r.fillText(e,i,a),r.strokeText(e,i,a)}})),requestAnimationFrame(h)}a.addEventListener("play",(()=>{o.width=a.clientWidth,o.height=a.clientHeight,requestAnimationFrame(h)}))})),s.addEventListener("input",(()=>{const t=Number(s.value)/100*a.duration;Number.isNaN(t)||(a.currentTime=t,r.clearRect(0,0,o.width,o.height),r.drawImage(a,0,0,o.width,o.height),a.pause())})),a.addEventListener("timeupdate",(()=>{const t=a.currentTime/a.duration*100;s.value=t.toString(),L(c,S,0),L(u,y,1),L(h,v,2),L(m,f,3),L(p,E,4),L(b,T,5)}))},this.selectClip=()=>{document.getElementById("selected-tab-indicator").addEventListener("click",(()=>{"Tutorial"===this.tabTitle&&this.initSelectFirstClipTutorialFlow();const t=document.getElementById("popup-modal");t.innerHTML=this.buildTabChunkHTML(),this.addClosePopupListener();const e=document.getElementsByClassName("tab-chunk-text");for(let t=0;t<e.length;t++)e[t].addEventListener("click",(n=>{"Tutorial"===this.tabTitle&&this.initSetStartPointFlow();const i=document.getElementById("selected-tab-indicator");for(let t=0;t<e.length;t++)e[t].classList.remove("tab-segment-selected");i.style.backgroundColor=e[t].getAttribute("color"),i.innerHTML="Clip "+(t+1),this.adjustTabChunkTime(e[t]),e[t].classList.add("tab-segment-selected")}));t.style.display="flex"}))},this.getUserAccount=()=>n(this,void 0,void 0,(function*(){const t=window.location.search,e=new URLSearchParams(t),n=e.get("username"),o=yield fetch(i+"getUserAccount?username="+n),r=yield o.json(),a=e.get("title");"Tutorial"===a&&this.initTutorial(),this.tabTitle=a,this.user=r;const s=this.user.tabs.find((t=>t.tabTitle===a));l.tab=this.splitTabIntoChunks(this.formatTabForPDFExport(s.tabData)),l.tabChunks=this.splitTabIntoChunks(this.formatTabForPDFExport(s.tabData)),this.initVideoUpload()})),this.resetGuestTab=()=>n(this,void 0,void 0,(function*(){yield fetch(i+"saveTab",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tabData:{highEString:"------------",bString:"------------",gString:"------------",dString:"------------",aString:"------------",eString:"------------"},username:"Guest",tabTitle:"My Tab"})})})),this.splitTabIntoChunks=t=>{const e=t.highEString.split(""),n=t.bString.split(""),i=t.gString.split(""),o=t.dString.split(""),r=t.aString.split(""),l=t.eString.split("");let a=[],s=[],d=[],g=[],c=[],u=[];const h={highEString:[],bString:[],gString:[],dString:[],aString:[],eString:[]};let m=31,p=this.TIMER;for(let t=0;t<e.length;t++)a.push(e[t]),s.push(n[t]),d.push(i[t]),g.push(o[t]),c.push(r[t]),u.push(l[t]),t!==m&&t!==e.length-1||(a=this.ensureStringsAreSameLength(a),s=this.ensureStringsAreSameLength(s),d=this.ensureStringsAreSameLength(d),g=this.ensureStringsAreSameLength(g),c=this.ensureStringsAreSameLength(c),u=this.ensureStringsAreSameLength(u),a.unshift("E|"),s.unshift("B|"),d.unshift("G|"),g.unshift("D|"),c.unshift("A|"),u.unshift("E|"),h.highEString.push({text:a.join(""),id:t,time:{start:p,end:p+this.TIMER}}),h.bString.push({text:s.join(""),id:t,time:{start:p,end:p+this.TIMER}}),h.gString.push({text:d.join(""),id:t,time:{start:p,end:p+this.TIMER}}),h.dString.push({text:g.join(""),id:t,time:{start:p,end:p+this.TIMER}}),h.aString.push({text:c.join(""),id:t,time:{start:p,end:p+this.TIMER}}),h.eString.push({text:u.join(""),id:t,time:{start:p,end:p+this.TIMER}}),m+=31,p+=this.TIMER,a.splice(0,t),s.splice(0,t),d.splice(0,t),g.splice(0,t),c.splice(0,t),u.splice(0,t));return h},this.ensureStringsAreSameLength=t=>{if(t.length<31)for(let e=t.length;e<31;e++)t.push("-");return t},this.formatTabForPDFExport=t=>{const e=this.findLongestString(t),n={highEString:[],bString:[],gString:[],dString:[],aString:[],eString:[]};let i,o,r,l,a,s;"string"==typeof t.highEString?(i=t.highEString.split(""),o=t.bString.split(""),r=t.gString.split(""),l=t.dString.split(""),a=t.aString.split(""),s=t.eString.split("")):(i=t.highEString,o=t.bString,r=t.gString,l=t.dString,a=t.aString,s=t.eString);const d=Math.max(i.length,o.length,r.length,l.length,a.length,s.length);for(let e=0;e<d;e++)void 0===t.highEString[e]&&(t.highEString+="-"),void 0===t.bString[e]&&(t.bString+="-"),void 0===t.gString[e]&&(t.gString+="-"),void 0===t.dString[e]&&(t.dString+="-"),void 0===t.aString[e]&&(t.aString+="-"),void 0===t.eString[e]&&(t.eString+="-");for(let i=0;i<e;i++){const e=t.highEString[i],o=t.bString[i],r=t.gString[i],l=t.dString[i],a=t.aString[i],s=t.eString[i],d=t.highEString[i-1],g=t.bString[i-1],c=t.gString[i-1],u=t.dString[i-1],h=t.aString[i-1],m=t.eString[i-1],p=t.highEString[i+1],b=t.bString[i+1],S=t.gString[i+1],y=t.dString[i+1],v=t.aString[i+1],f=t.eString[i+1];"{"!==e&&(n.highEString.push(e),"{"!==d&&"}"!==p&&"}"!==e&&n.highEString.push("-")),"{"!==o&&(n.bString.push(o),"{"!==g&&"}"!==b&&"}"!==o&&n.bString.push("-")),"{"!==r&&(n.gString.push(r),"{"!==c&&"}"!==S&&"}"!==r&&n.gString.push("-")),"{"!==l&&(n.dString.push(l),"{"!==u&&"}"!==y&&"}"!==l&&n.dString.push("-")),"{"!==a&&(n.aString.push(a),"{"!==h&&"}"!==v&&"}"!==a&&n.aString.push("-")),"{"!==s&&(n.eString.push(s),"{"!==m&&"}"!==f&&"}"!==s&&n.eString.push("-"))}const g=n.highEString.join("").split(""),c=n.bString.join("").split(""),u=n.gString.join("").split(""),h=n.dString.join("").split(""),m=n.aString.join("").split(""),p=n.eString.join("").split(""),b=Math.max(g.length,c.length,u.length,h.length,m.length,p.length);let S={highEString:[],bString:[],gString:[],dString:[],aString:[],eString:[]};for(let t=0;t<b;t++)S.highEString.push(n.highEString[t]||"-"),S.bString.push(n.bString[t]||"-"),S.gString.push(n.gString[t]||"-"),S.dString.push(n.dString[t]||"-"),S.aString.push(n.aString[t]||"-"),S.eString.push(n.eString[t]||"-");S={highEString:S.highEString,bString:S.bString,gString:S.gString,dString:S.dString,aString:S.aString,eString:S.eString};let y=0;for(let t=0;t<S.highEString.length;t++){const e=S.highEString[t]||"-",n=S.bString[t]||"-",i=S.gString[t]||"-",o=S.dString[t]||"-",r=S.aString[t]||"-",l=S.eString[t]||"-";"-"===e&&"-"===n&&"-"===i&&"-"===o&&"-"===r&&"-"===l||(y=t),"}"===e&&(S.highEString[t]="-"),"}"===n&&(S.bString[t]="-"),"}"===i&&(S.gString[t]="-"),"}"===o&&(S.dString[t]="-"),"}"===r&&(S.aString[t]="-"),"}"===l&&(S.eString[t]="-"),"}"!==e&&"}"!==n&&"}"!==i&&"}"!==o&&"}"!==r&&"}"!==l||("}"===e?S.highEString[t]="-":S.highEString.splice(t,0,"-"),"}"===n?S.bString[t]="-":S.bString.splice(t,0,"-"),"}"===i?S.gString[t]="-":S.gString.splice(t,0,"-"),"}"===o?S.dString[t]="-":S.dString.splice(t,0,"-"),"}"===r?S.aString[t]="-":S.aString.splice(t,0,"-"),"}"===l?S.eString[t]="-":S.eString.splice(t,0,"-"))}const v={highEString:S.highEString.slice(0,y+4).join(""),bString:S.bString.slice(0,y+4).join(""),gString:S.gString.slice(0,y+4).join(""),dString:S.dString.slice(0,y+4).join(""),aString:S.aString.slice(0,y+4).join(""),eString:S.eString.slice(0,y+4).join("")},f=document.getElementById("tab-text-highEString"),E=document.getElementById("tab-text-bString"),T=document.getElementById("tab-text-gString"),k=document.getElementById("tab-text-dString"),L=document.getElementById("tab-text-aString"),w=document.getElementById("tab-text-eString");return f.innerHTML=S.highEString.slice(0,Math.min(S.highEString.length,S.bString.length,S.gString.length,S.dString.length,S.aString.length,S.eString.length)).join(""),E.innerHTML=S.bString.slice(0,Math.min(S.highEString.length,S.bString.length,S.gString.length,S.dString.length,S.aString.length,S.eString.length)).join(""),T.innerHTML=S.gString.slice(0,Math.min(S.highEString.length,S.bString.length,S.gString.length,S.dString.length,S.aString.length,S.eString.length)).join(""),k.innerHTML=S.dString.slice(0,Math.min(S.highEString.length,S.bString.length,S.gString.length,S.dString.length,S.aString.length,S.eString.length)).join(""),L.innerHTML=S.aString.slice(0,Math.min(S.highEString.length,S.bString.length,S.gString.length,S.dString.length,S.aString.length,S.eString.length)).join(""),w.innerHTML=S.eString.slice(0,Math.min(S.highEString.length,S.bString.length,S.gString.length,S.dString.length,S.aString.length,S.eString.length)).join(""),v},this.findLongestString=t=>{const e={stringName:"",stringLength:0};return Object.entries(t).forEach((t=>{const n=t[0],i=t[1].length;i>e.stringLength&&(e.stringName=n,e.stringLength=i)})),e.stringLength},this.user={},this.tabTitle="",this.tabClipSegmentColors=["#23FE69","#FF1493","#00FFFF","#9400D3","#FDFD00","#FF073A","#FDFD00"]}detectBrowser(){const t=navigator.userAgent;return/iP(hone|od|ad).*Safari/i.test(t)?"Safari Mobile":/Safari/i.test(t)&&!/Chrome/i.test(t)?"Safari":/Firefox/i.test(t)?"Firefox":"Other"}resetTimeline(){const t=document.getElementById("video-timeline");t&&(t.value="0",t.dispatchEvent(new Event("input")))}}l.isVideoPlaying=!1,l.tabBackgroundColor="black",l.tabFont="Inconsolata-Regular",l.colorMap={black:"rgba(20, 20, 20, 0.8)",red:"rgba(255, 69, 58, 0.8)",blue:"rgba(10, 132, 255, 0.8)",purple:"rgba(191, 90, 242, 0.8)",green:"rgba(52, 199, 89, 0.8)",orange:"rgba(255, 149, 0, 0.8)"},(new l).init()})();